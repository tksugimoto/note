<!DOCTYPE html>
<html>
<head>
	<title>クリップボードの中身のhtmlを確認 [JavaScript]</title>
	<style>
		body {
			width: 700px;
			margin-right: auto;
			margin-left: auto;
		}
		#input {
			width: 100%;
			height: 100px;
		}
		.outputs {
			display:flex;
		}
		.outputs .output {
			padding: 10px;
			width: 100%;
		}
		#output_text,
		#output_html {
			width: 100%;
			height: 400px;
		}
		.download-link:not([href]) {
			display: none;
		}
	</style>
</head>
<body>
<h1>クリップボードの中身のhtmlを確認</h1>
<textarea id="input" placeholder="ここにペースト"></textarea>
<div>
	<h2>types</h2>
	<ul id="output_types"></ul>
</div>
<div class="outputs">
	<div class="output">
		<h2>text</h2>
		<textarea id="output_text"></textarea>
		<a class="download-link" download="clipboard.txt" id="download_text">Textをダウンロード</a>
	</div>
	<div class="output">
		<h2>html</h2>
		<textarea id="output_html"></textarea>
		<a class="download-link" download="clipboard.html" id="download_html">HTMLをダウンロード</a>
	</div>
</div>
<script type="text/javascript">
const updateDownloadLink = (id, text) => {
	const link = document.getElementById(id);
	const blob = new Blob([text], {
		type: "text/plain"
	});
	link.href = URL.createObjectURL(blob);
};
document.getElementById("input").addEventListener("paste", evt => {
	evt.preventDefault();
	const clipboardData = evt.clipboardData;

	const types = clipboardData.types;
	const outputTypes = document.getElementById('output_types');
	outputTypes.innerText = '';
	types.forEach(type => {
		const li = document.createElement('li');
		li.innerText = type;
		outputTypes.appendChild(li);
	});

	const text = clipboardData.getData("text/plain");
	document.getElementById("output_text").innerText = text;
	updateDownloadLink("download_text", text);

	const html = clipboardData.getData("text/html");
	document.getElementById("output_html").innerText = html;
	updateDownloadLink("download_html", html);
});
</script>
</body>
